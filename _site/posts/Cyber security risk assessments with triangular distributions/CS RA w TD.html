<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Johannes Buck">
<meta name="dcterms.date" content="2024-01-06">
<meta name="description" content="Triangular distributions and opinion pooling are a simple and straightforward approach to quantitative cyber security risk management.">

<title>β Blog - Cyber security risk assessments with triangular distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/beta_blog_icon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">β Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/j-buck59/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:johannes.buck59@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Cyber security risk assessments with triangular distributions</h1>
                  <div>
        <div class="description">
          Triangular distributions and opinion pooling are a simple and straightforward approach to quantitative cyber security risk management.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">statistics</div>
                <div class="quarto-category">risk management</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Johannes Buck </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 6, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cyber-security-risk-management" id="toc-cyber-security-risk-management" class="nav-link active" data-scroll-target="#cyber-security-risk-management">Cyber security risk management</a></li>
  <li><a href="#quantitative-cyber-security-risk-assessments" id="toc-quantitative-cyber-security-risk-assessments" class="nav-link" data-scroll-target="#quantitative-cyber-security-risk-assessments">Quantitative cyber security risk assessments</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  <li><a href="#opinion-pooling" id="toc-opinion-pooling" class="nav-link" data-scroll-target="#opinion-pooling">Opinion Pooling</a>
  <ul class="collapse">
  <li><a href="#linear-opinion-pooling-lop" id="toc-linear-opinion-pooling-lop" class="nav-link" data-scroll-target="#linear-opinion-pooling-lop">Linear opinion pooling (LOP)</a></li>
  <li><a href="#logarithmic-opinion-pooling-logop" id="toc-logarithmic-opinion-pooling-logop" class="nav-link" data-scroll-target="#logarithmic-opinion-pooling-logop">Logarithmic opinion pooling (LogOP)</a></li>
  <li><a href="#linear-opinion-pooling-vs.-logarithmic-opinion-pooling" id="toc-linear-opinion-pooling-vs.-logarithmic-opinion-pooling" class="nav-link" data-scroll-target="#linear-opinion-pooling-vs.-logarithmic-opinion-pooling">Linear opinion pooling vs.&nbsp;logarithmic opinion pooling</a>
  <ul class="collapse">
  <li><a href="#lop-example" id="toc-lop-example" class="nav-link" data-scroll-target="#lop-example">LOP Example</a></li>
  <li><a href="#logop-example" id="toc-logop-example" class="nav-link" data-scroll-target="#logop-example">LogOP Example</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>In a quantitative risk calculation, a triangle distribution is a probability distribution that assumes a minimum, maximum, and most likely value for a variable. It is often used when the available data is limited, and we have some knowledge about the range of possible values.</p>
<section id="cyber-security-risk-management" class="level1">
<h1>Cyber security risk management</h1>
<p><img src="images/Risk Management Process.png" class="img-fluid"></p>
<p>Figure 1: Risk management process</p>
<p>The risk management process has four stages:</p>
<ol type="1">
<li><strong>Identify risk -</strong> assess the organization’s environment to identify current or potential risks that could affect business operations.</li>
<li><strong>Assess risk -</strong> analyze likelihood and impact to the organization of the identified risks</li>
<li><strong>Manage risk -</strong> define measures to mitigate the risks</li>
<li><strong>Monitor controls -</strong> continuously evaluate control effectiveness and add or adjust controls as needed</li>
</ol>
</section>
<section id="quantitative-cyber-security-risk-assessments" class="level1">
<h1>Quantitative cyber security risk assessments</h1>
<p>Risk is a function of the probability of occurrence of an event and the impact of that event on the business:</p>
<p><img src="images/Risk Equation.png" class="img-fluid"></p>
<p>Figure 2: Risk Equation</p>
<p>Cyber security risk assessments can be performed using qualitative or quantitative methods. In this post we will discuss how the triangular distribution can be used for simple and straightforward quantitative cyber security risk assessments. In a subsequent post, we will discuss how the Monte Carlo simulation can be used for a more sophisticated approach to quantitative cyber security risk assessments.</p>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>Company XYZ has assessed the potential financial impact of a data breach. Based on historical data and expert judgment, they estimate the following values for the financial impact (in USD) with a triangle distribution:</p>
<ul>
<li><p>Minimum financial impact: a = USD 40,000</p></li>
<li><p>Most likely financial impact (mode): c = USD 150,000</p></li>
<li><p>Maximum financial impact: b = USD 60,000</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="CS-RA-w-TD_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Results</strong></p>
<p>The triangle distribution parameters are:</p>
<ul>
<li><p>Expected value: USD 85,000</p></li>
<li><p>Probability of the expected value: 0.553 (55%)</p></li>
<li><p>Confidence Interval [lower bound]: USD 51,000</p></li>
<li><p>Confidence Interval [upper band]: USD 135,000</p></li>
</ul>
<p><strong>Interpretation</strong></p>
<ul>
<li><p>The 95% confidence interval covers almost the entire range of the triangular distribution.</p></li>
<li><p>The probability of the expected value is only 55%.</p></li>
</ul>
<p>These two conclusions tell us that the expected value is characterized by a high degree of uncertainty which is typical of a skewed triangular distribution.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Confidence interval
</div>
</div>
<div class="callout-body-container callout-body">
<p>Various methods can be used to calculate a confidence interval for the triangular distribution. It is important to note that these methods are based on assumptions and may not always be accurate, especially if the triangular distribution is highly asymmetric. In such cases, more advanced statistical methods may be required.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expected value
</div>
</div>
<div class="callout-body-container callout-body">
<p>The expected value is a commonly used measurement in quantitative risk management. The expected value provides a single “numerical summary” of a probability distribution. However, it is important to note that relying solely on the expected value may have limitations. The probability of the expected value, the confidence interval, and a good understanding of the underlying probability distribution help to better understand the risk profile and make more comprehensive risk management decisions.</p>
</div>
</div>
</section>
</section>
<section id="opinion-pooling" class="level1">
<h1>Opinion Pooling</h1>
<section id="linear-opinion-pooling-lop" class="level2">
<h2 class="anchored" data-anchor-id="linear-opinion-pooling-lop">Linear opinion pooling (LOP)</h2>
<p>The results of triangular distributions can be aggregated by combining multiple triangular distributions to represent the overall uncertainty. This can be done by taking the minimum of the minimum values, the maximum of the maximum values, and aggregating the modes to form a new triangular distribution that represents the combined uncertainty. One approach to this is opinion pooling.</p>
<p>The following formula can be used for linear opinion pooling: <span class="math display">\[LOP = \sum_{i=1}^{N} (w_i \times o_i)\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(N\)</span> is the number of experts resp. opinions</p></li>
<li><p><span class="math inline">\(o_i\)</span> is the opinion of expert <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(w_i\)</span> is the weight of expert <span class="math inline">\(i\)</span> (used to reflect the trustworthiness of expert <span class="math inline">\(i\)</span>)</p></li>
</ul>
<p>Note: <span class="math inline">\(w_i\)</span> are the non-negative weights such that&nbsp;<span class="math inline">\(\sum_{i} w_i = 1\)</span>, with&nbsp;<span class="math inline">\(w_1= w_2= \ldots = w_k = 1/k\)</span>&nbsp;if all the opinions as equally trustworthy.</p>
<p>If no weighting is used: <span class="math display">\[LOP = \frac {1}{N} \sum_{i=1}^{N} o_i\]</span></p>
</section>
<section id="logarithmic-opinion-pooling-logop" class="level2">
<h2 class="anchored" data-anchor-id="logarithmic-opinion-pooling-logop">Logarithmic opinion pooling (LogOP)</h2>
<p>Logarithmic opinion pooling is a method used to combine opinions from multiple experts. The basic idea is to take the logarithm of the individual probabilities and then average them. This helps prevent extreme opinions from dominating the final result.</p>
<p>The following formula can be used for logarithmic opinion pooling: <span class="math display">\[LogOp = \exp \left(\sum_{i=1}^{N} w_i \times \ln(o_i) \right)\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(N\)</span> is the number of experts resp. opinions</p></li>
<li><p><span class="math inline">\(o_i\)</span> is the opinion of expert <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(w_i\)</span> is the weight of expert <span class="math inline">\(i\)</span> (used to reflect the trustworthiness of expert <span class="math inline">\(i\)</span>)</p></li>
</ul>
<p>If no weighting is used: <span class="math display">\[LogOp = \frac{1}{N} \exp \left(\sum_{i=1}^{N} \ln(o_i) \right)\]</span></p>
</section>
<section id="linear-opinion-pooling-vs.-logarithmic-opinion-pooling" class="level2">
<h2 class="anchored" data-anchor-id="linear-opinion-pooling-vs.-logarithmic-opinion-pooling">Linear opinion pooling vs.&nbsp;logarithmic opinion pooling</h2>
<p>Linear opinion pooling and logarithmic opinion pooling are two methods used in combining multiple opinions to form a collective opinion. The choice between these methods depends on the characteristics of the underlying beliefs and the desired properties of the aggregated opinion.</p>
<p><strong>1. Linear Opinion Pooling (LOP)</strong></p>
<ul>
<li><p><strong>Applicability:</strong> Linear pooling is often suitable when the underlying opinions are assumed to be independent and equally weighted.</p></li>
<li><p><strong>Characteristics:</strong> This method assumes that each opinion contributes equally to the collective belief. It is straightforward and easy to implement.</p></li>
<li><p><strong>Use Cases:</strong> Linear pooling may be appropriate when there is no reason to believe that any source of information is more reliable or more influential than others.</p></li>
</ul>
<p><strong>2. Logarithmic Opinion Pooling (LogOP)</strong></p>
<ul>
<li><p><strong>Applicability:</strong> Logarithmic pooling is more suitable when there is a need to underweight extreme opinions and give more importance to the middle-ground opinions.</p></li>
<li><p><strong>Characteristics:</strong> It is based on the assumption that extreme opinions (outliners) are more likely to be incorrect or biased, and thus they should have less impact on the final aggregated opinion. Note that the logarithmic pooling can produce an aggregated probability that is zero, even if none of the experts assign a probability of zero to the outcome. This is because the logarithmic function is unbounded below.</p></li>
<li><p><strong>Use Cases:</strong> Logarithmic pooling might be more appropriate in situations where there is a possibility of extreme opinions being outliers or influenced by noise, and a more conservative approach to combining opinions is desired.</p></li>
</ul>
<p>The choice between linear and logarithmic opinion pooling depends on the context and the specific characteristics of the data. Linear and logarithmic opinion pooling are not the only methods available. Other approaches such as Bayesian aggregation, may also be considered.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Probabilistic opinion
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pooling is a concept developed by Franz Dietrich. It refers to methods for combining the opinions or judgments of multiple individuals and generating a joint probability distribution for a given statement or hypothesis. Dietrich is a researcher in the field of decision theory and formal social choice theory.</p>
</div>
</div>
<section id="lop-example" class="level3">
<h3 class="anchored" data-anchor-id="lop-example">LOP Example</h3>
<p><strong>Scenario</strong></p>
<p>DDoS attack on the organization, where three experts estimate the probability of occurrence and potential impact.</p>
<p><strong>Estimations</strong></p>
<ul>
<li><p>Expert A: probability = 0.7; impact = USD 100,000 =&gt; risk = USD 70,000</p></li>
<li><p>Expert B: probability = 0.6; impact = USD 300,000 =&gt; risk = USD 180,000</p></li>
<li><p>Expert C: probability = 0.8; impact = USD 200,000 =&gt; risk = USD 160,000</p></li>
</ul>
<p><strong>Trustworthiness</strong></p>
<p>The trustworthiness or expertise of the experts can be weighted:</p>
<ul>
<li><p>Expert A: <span class="math inline">\(w_A\)</span> = 0.3</p></li>
<li><p>Expert B: <span class="math inline">\(w_B\)</span> = 0.4</p></li>
<li><p>Expert C: <span class="math inline">\(w_C\)</span> = 0.3</p></li>
</ul>
<p>Note: The sum of all weighting factors should be 1.0.</p>
<p><strong>Overall Assessment</strong></p>
<p>Calculate the overall assessment by applying the linear pooling method: <span class="math display">\[\text{Overall assessment} = w_A \times \text{risk}_A + w_B \times \text{risk}_B + w_C \times \text{risk}_C\]</span> <span class="math display">\[\text{Overall assessment} = 0.3 \times \text{USD 70,000} + 0.4 \times \text{USD 180,000} + 0.3 \times \text{USD 160,000} = \text{USD 141,000}\]</span></p>
</section>
<section id="logop-example" class="level3">
<h3 class="anchored" data-anchor-id="logop-example">LogOP Example</h3>
<p>Used the same scenario and the same values for the expert estimations and trustworthiness as in the LOP example.</p>
<p>The logarithmic opinion pooling formula is: <span class="math display">\[LogOp(r_1,r_2,r_3)= \exp⁡(w_1 \times ln⁡(r_1)+w_2 \times ln⁡(r_2)+w_3 \times ln⁡(r_3))\]</span></p>
<p><span class="math display">\[LogOp(70,180,160)= \exp⁡(0.3 \times ln⁡(70)+0.4 \times ln⁡(180)+ 0.3 \times ln⁡(160))\]</span></p>
<p><span class="math display">\[LogOp(70,180,160)= \text{USD 1k } 130.880\]</span></p>
<p><strong>Overall Assessment</strong></p>
<p>The overall assessment calculated with logarithmic pooling is USD 130,880. The result of the logarithmic pooling is compared with the linear opinion pooling lower (USD 130,880 &lt; USD 141,000) because of the effect to correct outliners (risk estimation of expert A which is significantly lower then the risks estimated by the experts B and C).</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="viper-007/Beta-Blog" data-repo-id="R_kgDOJqefag" data-category="General" data-category-id="DIC_kwDOJqefas4CW6NB" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Made with <a href="https://quarto.org/">Quarto</a> by Johannes Buck. License: <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>